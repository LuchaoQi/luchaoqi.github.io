<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Perceptron from Scratch - Luchao Qi</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Luchao Qi"><meta name="msapplication-TileImage" content="/img/favicon_io/pngtosvg.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Luchao Qi"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content=""><meta property="og:type" content="blog"><meta property="og:title" content="Perceptron from Scratch"><meta property="og:url" content="https://luchaoqi.github.io/blog/Perceptron-from-Scratch/"><meta property="og:site_name" content="Luchao Qi"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://luchaoqi.github.io/blog/Perceptron-from-Scratch/img/favicon_io/avatar.jpg"><meta property="article:published_time" content="2021-07-08T01:41:46.000Z"><meta property="article:modified_time" content="2021-07-08T14:32:48.217Z"><meta property="article:author" content="Luchao Qi"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="img/favicon_io/avatar.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://luchaoqi.github.io/blog/Perceptron-from-Scratch/"},"headline":"Perceptron from Scratch","image":["https://upload.wikimedia.org/wikipedia/commons/thumb/8/8a/Perceptron_example.svg/500px-Perceptron_example.svg.png"],"datePublished":"2021-07-08T01:41:46.000Z","dateModified":"2021-07-08T14:32:48.217Z","author":{"@type":"Person","name":"Luchao Qi"},"publisher":{"@type":"Organization","name":"Luchao Qi","logo":{"@type":"ImageObject","url":"https://luchaoqi.github.io/img/favicon_io/pngtosvg.svg"}},"description":""}</script><link rel="canonical" href="https://luchaoqi.github.io/blog/Perceptron-from-Scratch/"><link rel="alternate" href="https://luchaoqi.com/atom" title="Luchao Qi" type="application/atom+xml"><link rel="icon" href="/img/favicon_io/pngtosvg.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/monokai.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-168448832-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-168448832-1');</script><!--!--><meta name="generator" content="Hexo 5.0.2"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon_io/pngtosvg.svg" alt="Luchao Qi" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/projects">Projects</a><a class="navbar-item" target="_blank" rel="noopener" href="https://luchaoqi.com/doc/Resume/Resume.pdf">Resume</a><a class="navbar-item" href="/archives">Archives</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Blog" href="http://luchaoqi.com/blog"><i class="fas fa-blog"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-07-08T01:41:46.000Z" title="7/7/2021, 9:41:46 PM">2021-07-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-08T14:32:48.217Z" title="7/8/2021, 10:32:48 AM">2021-07-08</time></span><span class="level-item"><a class="link-muted" href="/categories/Machine-Learning/">Machine Learning</a></span><span class="level-item">3 minutes read (About 495 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Perceptron from Scratch</h1><div class="content"><p>Perceptron is the basic unit for neural network<br>$$<br>\begin{aligned}f\left( x\right) =sign\left( w^{T}x\right) \ sign\left( a\right) =\begin{cases}+1,a\geq 0\ -1,a &lt;0\end{cases}\end{aligned}<br>$$<br>where $f(x)$ is the prediction and $x$ is the input matrix e.g. $[x,y]$ which is same as $[x_{1},x_{2}]$</p>
<p>The loss function is:<br>$$<br>\begin{align<em>}<br>L &amp;= \sum <em>{i\in Incorrections}-y</em>{i}\cdot \left( w^{T}\cdot x_{i}+b\right) \tag{1}\<br>L &amp;= \sum ^{N}<em>{n=1}\max \left{ -yi\cdot \left( w^{T}x</em>{i}+b\right) ,0\right} \tag{2}\<br>L_{hinge} &amp;= \sum ^{N}<em>{n=1} max(1-y{i}\cdot(w^Tx</em>{i}+b),0) \tag{3}<br>\end{align</em>}<br>$$</p>
<blockquote>
<p>It’s easy to derive (2) from (1), moving on, we find the derivatives in (2) is the same as the derivatives in (3). It’s intuitive to find that hinge loss function is commonly used in distance-related classification algorithms e.g. SVM.</p>
</blockquote>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8a/Perceptron_example.svg/500px-Perceptron_example.svg.png" alt="A diagram showing a perceptron updating its linear boundary as more training examples are added"></p>
<p>Question:</p>
<p>why not use the total number of incorrect predictions as the loss function:<br>$$<br>L = \sum ^{N}<em>{n=1} I\left{ y</em>{i}w^Tx_{i}&lt;0 \right}\<br>\text{I is the indicator function}<br>$$<br>The reason is that this loss function is non-differentiable since L is basically 1-0 loss.</p>
<p>Using stochastic gradient descent, we can break it down with steps:</p>
<ol>
<li>pick one incorrect data point</li>
<li>update weight/bias based on derivatives i.e. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Hinge_loss">gradient of hinge loss</a></li>
<li>repeat until all data points are correctly labeled</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign</span>(<span class="params">f</span>):</span></span><br><span class="line">    <span class="keyword">if</span> f&gt;=<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">perceptron</span>(<span class="params">data,labels,lr=<span class="number">0.1</span>,n_iter=<span class="number">1</span>_000</span>):</span></span><br><span class="line">    weights = np.ones(len(data[<span class="number">0</span>]))</span><br><span class="line">    bias = <span class="number">0</span> <span class="comment"># note some ppl prefer combining weights and bias togther s.t. weights = [w,b] and y_pred = weights.T.dot([x_i,1])</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> range(n_iter):</span><br><span class="line">        error = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)): </span><br><span class="line">            x_i,y_i = data[i],labels[i]</span><br><span class="line">            y_pred = sign(weights.T.dot(x_i)+bias)</span><br><span class="line">            <span class="keyword">if</span> y_pred*y_i&lt;=<span class="number">0</span>: <span class="comment"># step 1: y_pred,y_i = (-1,1) OR (1,-1)</span></span><br><span class="line">                <span class="comment"># step 2: update weight/bias based on derivatives</span></span><br><span class="line">                d_weights = -y_i*np.array(x_i)</span><br><span class="line">                d_bias = -y_i</span><br><span class="line">                weights = weights - lr*d_weights</span><br><span class="line">                bias = bias - lr*d_bias</span><br><span class="line">                error += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> error == <span class="number">0</span>: <span class="comment"># step 3</span></span><br><span class="line">            print(<span class="string">&#x27;Optimization finished with &#123;&#125; iterations&#x27;</span>.format(n))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    print(<span class="string">&#x27;weights :&#x27;</span>, *weights)</span><br><span class="line">    print(<span class="string">&#x27;bias: &#x27;</span>,bias)</span><br><span class="line">    res = [weights.T.dot(x)+bias <span class="keyword">for</span> x <span class="keyword">in</span> data]</span><br><span class="line">    res = list(map(sign,res))</span><br><span class="line">    print(<span class="string">&#x27;res: &#x27;</span>,res)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># AND</span></span><br><span class="line">data = [[<span class="number">0</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">0</span>],[<span class="number">1</span>,<span class="number">1</span>]]</span><br><span class="line">labels = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">-1</span>]</span><br><span class="line">perceptron(data,labels)</span><br><span class="line"><span class="comment"># Optimization finished with 15 iterations</span></span><br><span class="line"><span class="comment"># weights : -0.19999999999999987 -0.09999999999999987</span></span><br><span class="line"><span class="comment"># bias:  0.2</span></span><br><span class="line"><span class="comment"># res:  [1, 1, 1, -1]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># XOR</span></span><br><span class="line"><span class="comment"># Try the famous XOR problem with one single perceptron</span></span><br><span class="line"><span class="comment"># Due to the nature of linear separability, it&#x27;ll never classify dataset correctly.</span></span><br><span class="line">labels = [<span class="number">1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">1</span>]</span><br><span class="line">perceptron(data,labels)</span><br><span class="line"><span class="comment"># weights : 0.20000000000000015 0.20000000000000015</span></span><br><span class="line"><span class="comment"># bias:  -0.20000000000000004</span></span><br><span class="line"><span class="comment"># res:  [1, 1, 1, 1]</span></span><br></pre></td></tr></table></figure>



<p>Resources:</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Hinge_loss">https://en.wikipedia.org/wiki/Hinge_loss</a></p>
<p><a target="_blank" rel="noopener" href="https://www.python-engineer.com/courses/mlfromscratch/06_perceptron/">https://www.python-engineer.com/courses/mlfromscratch/06_perceptron/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1aE411o7qd?p=14">https://www.bilibili.com/video/BV1aE411o7qd?p=14</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Perceptron from Scratch</p><p><a href="https://luchaoqi.github.io/blog/Perceptron-from-Scratch/">https://luchaoqi.github.io/blog/Perceptron-from-Scratch/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Luchao Qi</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-07-07</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-07-08</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="" rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p></div></div></div></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/blog/Subsequence/"><span class="level-item">Subsequence</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://luchaoqi.github.io/blog/Perceptron-from-Scratch/';
            this.page.identifier = 'blog/Perceptron-from-Scratch/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'luchaoqi' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-08T01:41:46.000Z">2021-07-07</time></p><p class="title"><a href="/blog/Perceptron-from-Scratch/">Perceptron from Scratch</a></p><p class="categories"><a href="/categories/Machine-Learning/">Machine Learning</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-06-22T18:07:54.000Z">2021-06-22</time></p><p class="title"><a href="/blog/Subsequence/">Subsequence</a></p><p class="categories"><a href="/categories/Data-Structure/">Data Structure</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-06-04T21:44:01.000Z">2021-06-04</time></p><p class="title"><a href="/blog/K-Means-from-Scratch/">K-Means from Scratch</a></p><p class="categories"><a href="/categories/Machine-Learning/">Machine Learning</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-04-13T20:33:02.000Z">2021-04-13</time></p><p class="title"><a href="/blog/2021-Year-End-Recap/">2021 Year End Recap</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-05-30T04:00:00.000Z">2020-05-30</time></p><p class="title"><a href="/blog/Farewell-to-the-Johns-Hopkins-University/">Farewell to the Johns Hopkins University</a></p></div></article></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon_io/pngtosvg.svg" alt="Luchao Qi" height="28"></a><p class="is-size-7"><span>&copy; 2021 Luchao Qi</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>